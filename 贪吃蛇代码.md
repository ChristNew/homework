/*WHILE not 游戏结束 DO
ch＝等待输入
CASE ch DO
‘A’:左前进一步，break
‘D’:右前进一步，break
‘W’:上前进一步，break
‘S’:下前进一步，break
END CASE
If
前进一步 = *
输出 Game Over!!!
END WHILE
Else if
前进一步 = 身体
输出 Game Over!!!
END WHILE
Else if
前进一步 = 食物
身体变长一节
输出字符矩阵
Else
输出字符矩阵
END WHILE
输出 Game Over!!!
*/
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <windows.h>
#define SNAKE_MAX_LENGTH 20
#define SNAKE_HEAD 'H'
#define SNAKE_BODY 'X'
#define SNAKE_CELL ' '
#define SNAKE_FOOD '$'
#define WALL_CELL '*'
void snakemove(int, int);//蛇的移动
void putout(void);//根据坐标打印图案
void put_food(void);//放置食物

int foodX = 0;
int foodY = 0;//食物的坐标
char map[12][13] = {
	"************",
	"*XXXXH     *",
	"*          *",
	"*          *",
	"*          *",
	"*          *",
	"*          *",
	"*          *",
	"*          *",
	"*          *",
	"*          *",
	"************"
};//初始地图
int snakeX[SNAKE_MAX_LENGTH] = { 1,2,3,4,5 };
int snakeY[SNAKE_MAX_LENGTH] = { 1,1,1,1,1 };//贪吃蛇的初始位置
int snakelength = 5;//蛇的初始长度

int main()
{
	srand(time(NULL));
	put_food();//先生成食物
	putout();//打印初始地图
	int dx = 0, dy = 0;
	char direction;
	while ((direction = getchar()) != EOF)
	{
		getchar();
		system("CLS");
		switch (direction)
		{
		case'W':
			dy = -1;
			dx = 0;
			break;
		case'S':
			dy = 1;
			dx = 0;
			break;
		case'A':
			dx = -1;
			dy = 0;
			break;
		case'D':
			dx = 1;
			dy = 0;
			break;
		}
		snakemove(dx, dy);
	}

	return 0;
}
void putout()
{
	int i = 0;
	for (i = 0; i < 12; i++)
		printf("%s\n", map[i]);
}
void put_food()
{
	foodX = rand() % 10 + 1;
	foodY = rand() % 10 + 1;
	while (map[foodX][foodY] != ' ')
	{
		foodX = rand() % 10 + 1;
		foodY = rand() % 10 + 1;

	}
	map[foodY][foodX] = SNAKE_FOOD;


}
void snakemove(int dx, int dy)
{
	int ssnakex = snakeX[0];
	int ssnakey = snakeY[0];
	int i = 0;
	map[snakeY[i]][snakeX[i]] = ' ';
	for (i = 0; i < snakelength - 1; i++)
	{
		snakeX[i] = snakeX[i + 1];
		snakeY[i] = snakeY[i + 1];
	}
	snakeX[snakelength - 1] += dx;
	snakeY[snakelength - 1] += dy;

	if (map[snakeY[snakelength - 1]][snakeX[snakelength - 1]] == '*'
		|| map[snakeY[snakelength - 1]][snakeX[snakelength - 1]] == 'X')
	{
		system("CLS");
		printf("gameover\n");
	}
	else if (map[snakeY[snakelength - 1]][snakeX[snakelength - 1]] == ' ')
	{
		map[snakeY[snakelength - 1]][snakeX[snakelength - 1]] = 'H';
		for (i = 0; i < snakelength - 1; i++)
		{
			map[snakeY[i]][snakeX[i]] = 'X';
		}
	}
	else if (map[snakeY[snakelength - 1]][snakeX[snakelength - 1]] == '$')
	{
		snakelength++;
		for (i = snakelength - 1; i>0; i--)
		{
			snakeX[i] = snakeX[i - 1];
			snakeY[i] = snakeY[i - 1];
		}
		snakeX[0] = ssnakex;
		snakeY[0] = ssnakey;
		for (i = 0; i<snakelength - 1; i++)
		{
			map[snakeY[i]][snakeX[i]] = 'X';
		}
		map[snakeY[snakelength - 1]][snakeX[snakelength - 1]] = 'H';
		put_food();
	}
	putout();


}


